<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Goil Community</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Lato:wght@100;300;400;700;900&display=swap"
      rel="stylesheet"
    />
    <style>
      *,
      *::before,
      *::after {
        box-sizing: border-box;
      }

      * {
        margin: 0;
      }

      body {
        margin: 0;
        background-color: #fff;
        font-family: "Inter", sans-serif;
        font-family: "Lato", system-ui, Avenir, Helvetica, Arial, sans-serif;
        padding: 0;
        margin: 0;
      }

      .disclaimer {
        padding: 3.5rem 1.5rem 0;
        text-align: center;
      }

      .logo {
        display: flex;
        align-items: center;
      }

      .logo .icon {
        height: 48px;
        margin-right: 0.75rem;
      }

      .logo .text {
        height: 32px;
      }

      h1 {
        margin: 3rem 0;
        font-size: 3rem;
        text-align: center;
      }

      h2 {
        margin-bottom: 1rem;
      }

      h4 {
        margin-top: 0.75rem;
        margin-bottom: 0.5rem;
      }

      p + p {
        margin-top: 1rem;
      }

      label {
        display: block;
        margin-bottom: 0.5rem;
      }

      .section-title {
        font-style: normal;
        font-weight: 700;
        line-height: normal;

        font-size: 2rem;
        font-weight: bold;
        margin-bottom: 1.5rem;
      }

      .subtitle {
        font-size: 1.25rem;
        font-weight: 700;
        margin-bottom: 1.5rem;
      }

      .row {
        margin: 0 -1rem;
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
      }

      .row + .row {
        margin-top: 1rem;
      }

      .container {
        padding: 1.75rem 2rem;
        border-radius: 2rem;
        background: rgba(255, 255, 255, 0.4);
        backdrop-filter: blur(2px);
      }

      .container + .container {
        margin-top: 2rem;
      }

      .content {
        width: 100%;
        max-width: 1400px;
        margin: 0 auto;
      }

      .col {
        flex: 0 0 auto;
        width: 100%;
        max-width: 100%;
        padding: 0 1rem;
      }

      .row-cols-2 > * {
        width: 100%;
      }

      .row-cols-5 > * {
        flex: 0 0 auto;
        width: 50%;
      }

      .row-cols-3 > * {
        flex: 0 0 auto;
        width: 50%;
      }

      input.form-control {
        display: block;
        width: 100%;
        padding: 10px 16px;
        font-size: 1rem;
        font-weight: 400;
        line-height: 1.5;
        color: #333;
        background-color: #fff;
        background-clip: padding-box;
        border: 1px solid #dad9d9;
        border-radius: 6px;
        transition:
          border-color 0.15s ease-in-out,
          background-color 0.15s ease-in-out,
          color 0.15s ease-in-out,
          box-shadow 0.15s ease-in-out;
      }

      input[type="color"] {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        width: 100%;
        height: 100px;
        background-color: transparent;
        border: none;
        cursor: pointer;
        margin: 0;
        padding: 0;
      }

      input[type="color"]::-webkit-color-swatch-wrapper {
        padding: 0;
        border-radius: 0;
      }

      input[type="color"]::-webkit-color-swatch {
        border: none;
        border-radius: 0;
      }

      input[type="file"] {
        margin-bottom: 3rem;
      }

      input[type="file"]::file-selector-button {
        border-radius: 6px;
        padding: 0 1rem;
        height: 40px;
        cursor: pointer;
        background-color: white;
        border: 1px solid rgba(0, 0, 0, 0.16);
        box-shadow: 0px 1px 0px rgba(0, 0, 0, 0.05);
        margin-right: 1rem;
        transition: background-color 200ms;
      }

      input[type="file"]::file-selector-button:hover {
        background-color: #f3f4f6;
      }

      input[type="file"]::file-selector-button:active {
        background-color: #e5e7eb;
      }

      .color-container {
        border-radius: 8px;
        overflow: hidden;
        background-color: #fff;
        margin-bottom: 1.5rem;
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
      }

      .color-container label {
        padding: 1rem;
        margin-bottom: 0;
        text-align: left;
        cursor: pointer;
      }

      button {
        width: 100%;
        margin-top: 2rem;
        color: #fff;
        border-radius: 32px;
        border: none;
        padding: 1rem 1.5rem;
        font-size: 1rem;
        font-weight: 500;
        font-family: inherit;
        background-color: #000;
        cursor: pointer;
      }

      button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      button:hover {
        background-color: #222;
      }

      button:focus,
      button:focus-visible {
        outline: 4px auto -webkit-focus-ring-color;
      }

      .form-group + .form-group {
        margin-top: 1.5rem;
      }

      .section {
        padding: 1rem 2rem;
      }

      .icon-col {
        margin-top: 1.5rem;
      }

      .first-section {
        background: linear-gradient(
          174deg,
          rgba(210, 175, 255, 0.56) 0%,
          rgba(186, 214, 255, 0.58) 98.05%
        );
      }

      .second-section {
        background: linear-gradient(
          174deg,
          rgba(186, 214, 255, 0.58) 0%,
          rgba(229, 224, 224, 0.56) 47.46%
        );
      }

      .third-section {
        background: linear-gradient(
            144deg,
            rgba(241, 238, 238, 0.09) 58.05%,
            rgba(255, 0, 0, 0.18) 86.21%
          ),
          linear-gradient(
            174deg,
            rgba(229, 224, 224, 0.56) 0%,
            rgba(186, 243, 255, 0.63) 98.05%
          );
      }

      .required {
        color: red;
      }

      .separator {
        height: 1px;
        background-color: #c0c0c0;
        margin-bottom: 1.5rem;
        margin: 2rem 0 1.5rem;
      }

      .success-modal {
        position: fixed;
        background-color: rgba(0, 0, 0, 0.6);
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        align-items: center;
        justify-content: center;
        padding: 3rem;
        display: none;
        transition: opacity 0.2s ease-out;
        opacity: 0;
      }

      .success-modal.show {
        display: flex;
        opacity: 1;
      }

      .success-modal .modal-content {
        background-color: #fff;
        padding: 2rem;
        border-radius: 10px;
        max-width: 600px;
      }

      @media (min-width: 768px) {
        .section {
          padding: 1.5rem 5rem;
        }

        .section-title {
          font-size: 2.5rem;
        }

        .container {
          padding: 2.5rem 3rem;
        }

        .col {
          width: auto;
        }

        .container + .container {
          margin-top: 3rem;
        }

        .form-group + .form-group {
          margin-top: 2rem;
        }

        .row-cols-2 > * {
          flex: 0 0 auto;
          width: 50%;
        }

        .row-cols-5 > * {
          flex: 0 0 auto;
          width: 20%;
        }

        .row-cols-3 > * {
          flex: 0 0 auto;
          width: 33.33333333%;
        }

        .color-container {
          margin-bottom: 0;
        }

        .icon-col,
        input[type="file"] {
          margin: 0;
        }
      }

      .col-general-phone {
        flex: 1 0 0%;
      }

      .col-general-phone .col {
        padding: 1rem;
      }

      .phone {
        width: 320px;
        height: 600px;
        border-radius: 48px;
        border: 18px solid #ccc;
        overflow: hidden;
        position: relative;
        margin: 0 auto;

        display: flex;
        justify-content: center;
        flex-direction: column;
      }

      .phone.phone-dashboard {
        justify-content: initial;
        background-position: center center;
        background-repeat: no-repeat;
        background-size: cover;
      }

      .phone::after {
        content: "";
        width: 100px;
        height: 28px;
        border-radius: 42px;
        background-color: #ccc;
        margin-top: 8px;
        z-index: 9999;

        position: absolute;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
      }

      .header-login {
        width: 400px;
        height: 400px;
        border-radius: 50%;
        background-color: #000;
        position: absolute;
        top: -50%;
        left: 50%;
        transform: translateX(-50%);
        margin-top: 50px;

        display: flex;
        justify-content: center;
        align-items: flex-end;
      }

      img[src=""] {
        opacity: 0;
      }

      .header-login .login-logo {
        object-fit: contain;
        width: 180px;
        height: 80px;
        margin-bottom: 38px;
        border: 0;
      }

      .progress-container {
        padding: 1.25rem;
        background-color: #000;
        margin-top: auto;
      }

      .progress-container .progress-bar {
        width: 60%;
        height: 4px;
        background-color: #fff;
        border-radius: 8px;
        margin: 0 auto;
        position: relative;
        display: flex;
        overflow: hidden;
      }

      .progress-container .progress-bar .progress-bar-value {
        background-color: #ccc;
        width: 60%;
        height: 100%;
        border-radius: 8px;
      }

      .dashboard-header {
        padding: 1rem;
        padding-top: 44px;
        text-align: center;
      }

      .dashboard-header .dashboard-logo,
      .dashboard-header .dashboard-sublogo {
        object-fit: contain;
        width: 128px;
        height: 38px;
        margin: 0 auto;
      }

      .dashboard-header .dashboard-sublogo {
        margin-top: 8px;
      }

      .circles {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .circles-container {
        display: flex;
        align-items: center;
        justify-content: center;

        width: 220px;
        height: 220px;
        border: 2px dashed #ccc;
        border-radius: 50%;
      }

      .circle-shield {
        width: 130px;
        height: 130px;
        background-color: #000;
        border-radius: 50%;

        display: flex;
        align-items: center;
        justify-content: center;
      }

      .shield {
        width: 72px;
        height: 72px;
      }

      .circle-section {
        width: 56px;
        height: 56px;
        background-color: #000;
        border-radius: 50%;
        margin: 0 -28px;

        position: absolute;
        top: 50%;
        left: 50%;
      }

      .circle-section.a1 {
        transform: rotate(90deg) translate(110px) rotate(-90deg);
      }

      .circle-section.a2 {
        transform: rotate(18deg) translate(110px) rotate(-18deg);
      }

      .circle-section.a3 {
        transform: rotate(-54deg) translate(110px) rotate(54deg);
      }

      .circle-section.a4 {
        transform: rotate(-126deg) translate(110px) rotate(126deg);
      }

      .circle-section.a5 {
        transform: rotate(-198deg) translate(110px) rotate(198deg);
      }

      .banner {
        width: 80%;
        height: 64px;
        background-color: #000;
        border-radius: 20px;
        margin: 0 auto;
        margin-bottom: 1rem;
      }

      .error {
        padding: 1rem;
        background-color: #f44336;
        border-radius: 10px;
        color: #fff;
        margin-bottom: 1rem;
        display: none;
      }

      .form-group {
        margin-bottom: 1rem;
      }
    </style>
  </head>
  <body>
    <form
      action="https://community.goil.app/api/v1/client/setup"
      method="post"
      enctype="multipart/form-data"
      id="businessForm"
    >
      <div class="section first-section">
        <div class="navbar">
          <div class="logo">
            <img src="./images/icon.svg" class="icon" />
            <img src="./images/logo.svg" class="text" />
          </div>
        </div>

        <h1>Dar de alta nuevo clientes</h1>

        <div class="error">
          Ha occurido un error desconocido, por favor vuelva a intentarlo más
          tarde o ponte en contacto con: lab@atlabs.tech
        </div>

        <div class="content">
          <div class="container">
            <div class="section-title">Cliente</div>
            <div class="row row-cols-2">
              <div class="col">
                <div class="form-group">
                  <label
                    >Nombre del negocio <span class="required">*</span></label
                  >
                  <input
                    type="text"
                    class="form-control"
                    name="business.name"
                    required
                    placeholder="Nombre del negocio"
                  />
                </div>

                <div class="form-group">
                  <label
                    >Código de acceso <span class="required">*</span></label
                  >
                  <input
                    type="text"
                    class="form-control"
                    name="business.authCode"
                    placeholder="AuthCode"
                    required
                    maxlength="5"
                    minlength="5"
                  />
                </div>

                <div class="form-group">
                  <label>Subdominio <span class="required">*</span></label>
                  <input
                    type="text"
                    required
                    class="form-control"
                    name="business.subDomain"
                    placeholder="Subdominio"
                  />
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="section second-section">
        <div class="content">
          <div class="container">
            <div class="section-title">Usuario administrador</div>
            <div class="row row-cols-2">
              <div class="col">
                <div class="form-group">
                  <label>Nombre <span class="required">*</span></label>
                  <input
                    type="text"
                    required
                    class="form-control"
                    name="client.firstName"
                    placeholder="Nombre"
                  />
                </div>

                <div class="form-group">
                  <label>Apellidos <span class="required">*</span></label>
                  <input
                    type="text"
                    required
                    class="form-control"
                    name="client.lastName"
                    placeholder="Apellidos"
                  />
                </div>

                <div class="form-group">
                  <label>Email <span class="required">*</span></label>
                  <input
                    type="text"
                    required
                    class="form-control"
                    name="client.email"
                    placeholder="Email"
                  />
                </div>

                <div class="form-group">
                  <label>Contraseña <span class="required">*</span></label>
                  <input
                    type="password"
                    required
                    class="form-control"
                    name="client.password"
                    placeholder="Contraseña"
                  />
                </div>
              </div>

              <div class="col icon-col">
                <label>Icono cuenta <span class="required">*</span></label>
                <input
                  type="file"
                  required
                  style="margin: 0"
                  name="accountTypeImage"
                />
              </div>
            </div>
          </div>

          <div class="container">
            <div class="section-title">Configuración App</div>
            <!-- <h4>Tema claro</h4> -->

            <div class="subtitle" style="margin-bottom: 0.5rem">Colores</div>
            <div class="row row-cols-5">
              <div class="col">
                <div class="color-container">
                  <input
                    type="color"
                    name="business.mobile.palette.primary"
                    id="mobilePrimary"
                    data-target="principalColor"
                  />
                  <label for="mobilePrimary">Principal</label>
                </div>
              </div>

              <div class="col">
                <div class="color-container">
                  <input
                    type="color"
                    name="business.mobile.palette.primaryText"
                    id="mobilePrimaryText"
                  />
                  <label for="mobilePrimaryText">Texto</label>
                </div>
              </div>

              <div class="col">
                <div class="color-container">
                  <input
                    type="color"
                    name="business.mobile.palette.primaryLoginHeader"
                    id="mobilePrimaryLoginHeader"
                    data-target="loginHeader"
                  />
                  <label for="mobilePrimaryLoginHeader">Cabecera login</label>
                </div>
              </div>

              <div class="col">
                <div class="color-container">
                  <input
                    type="color"
                    id="mobilePrimaryProgressBar"
                    name="business.mobile.palette.primaryProgressBar"
                    data-target="progressBar"
                  />
                  <label for="mobilePrimaryProgressBar"
                    >Barra de progreso del registro</label
                  >
                </div>
              </div>

              <div class="col">
                <div class="color-container">
                  <input
                    type="color"
                    id="mobilePrimaryBigCircle"
                    name="business.mobile.palette.primaryBigCircle"
                    data-target="shieldCircle"
                  />
                  <label for="mobilePrimaryBigCircle"
                    >Círculo pantalla secciones</label
                  >
                </div>
              </div>

              <!--<h4>Tema oscuro</h4>
            <div class="row">
              <div class="col">
                <label>Color primario</label>
                <input
                  type="color"
                  name="business.mobile.palette.primaryDark"
                />
              </div>
              <div class="col">
                <label>Color texto</label>
                <input
                  type="color"
                  name="business.mobile.palette.primaryTextDark"
                />
              </div>
              <div class="col">
                <label>Color progressBar</label>
                <input
                  type="color"
                  name="business.mobile.palette.primaryDarkProgressBar"
                />
              </div>
            </div>

            <div class="row">
              <div class="col">
                <label>Color círculo central</label>
                <input
                  type="color"
                  name="business.mobile.palette.primaryDarkBigCircle"
                />
              </div>
              <div class="col">
                <label>Color header login</label>
                <input
                  type="color"
                  name="business.mobile.palette.primaryDarkLoginHeader"
                />
              </div>
            </div> -->
            </div>

            <div class="separator"></div>

            <div class="subtitle" style="margin-bottom: 0.5rem">Ficheros</div>
            <div class="row row-cols-5">
              <div class="col">
                <label>Logo <span class="required">*</span></label>
                <input
                  type="file"
                  required
                  name="icon_lightImage"
                  data-target="loginLogo"
                />
              </div>
              <div class="col">
                <label
                  >Pantalla secciones header <small>(Opcional)</small></label
                >
                <input
                  type="file"
                  name="dashboardHeader_lightImage"
                  data-target="dashboardHeader"
                />
              </div>
              <div class="col">
                <label
                  >Pantalla secciones subheader <small>(Opcional)</small></label
                >
                <input
                  type="file"
                  name="dashboardSubheader_lightImage"
                  data-target="dashboardSubheader"
                />
              </div>
              <div class="col">
                <label
                  >Pantalla secciones imagen círculo central
                  <small>(Opcional)</small></label
                >
                <input
                  type="file"
                  name="dashboardShield_lightImage"
                  data-target="shieldImage"
                />
              </div>
              <div class="col">
                <label
                  >Pantalla secciones fondo <small>(Opcional)</small></label
                >
                <input
                  type="file"
                  style="margin: 0"
                  name="dashboardBackground_lightImage"
                  data-target="dashboardBackground"
                />
              </div>
            </div>

            <div class="separator"></div>

            <div class="row row-cols-2">
              <div class="col">
                <div class="phone">
                  <div class="header-login loginHeader">
                    <img class="login-logo" id="loginLogo" src="" />
                  </div>

                  <div class="progress-container">
                    <div class="progress-bar">
                      <div class="progress-bar-value progressBar"></div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col">
                <div class="phone phone-dashboard" id="dashboardBackground">
                  <div class="dashboard-header">
                    <img class="dashboard-logo" id="dashboardHeader" src="" />
                    <img
                      class="dashboard-sublogo"
                      id="dashboardSubheader"
                      src=""
                    />
                  </div>

                  <div class="circles">
                    <div class="circles-container">
                      <div class="circle-shield shieldCircle">
                        <div class="circle-section a1 principalColor"></div>
                        <div class="circle-section a2 principalColor"></div>
                        <div class="circle-section a3 principalColor"></div>
                        <div class="circle-section a4 principalColor"></div>
                        <div class="circle-section a5 principalColor"></div>
                        <img class="shield" id="shieldImage" src="" />
                      </div>
                    </div>
                  </div>

                  <div class="banner"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="section third-section">
        <div class="content">
          <div class="container">
            <div class="section-title">Configuración panel de control</div>

            <div class="form-group">
              <label>Versión</label>
              <input
                type="text"
                class="form-control"
                name="business.backoffice.version"
                pattern="^(\d+\.)?(\d+\.)?(\*|\d+)$"
                value="2.8.0"
              />
            </div>

            <div class="subtitle">Tema claro</div>
            <div class="row row-cols-2">
              <div class="col">
                <div class="color-container">
                  <input
                    type="color"
                    id="backofficePrimary"
                    name="business.backoffice.palette.primary"
                  />
                  <label for="backofficePrimary">Principal</label>
                </div>
              </div>
              <div class="col">
                <div class="color-container" style="margin: 0">
                  <input
                    type="color"
                    id="backofficePrimaryText"
                    name="business.backoffice.palette.primaryText"
                  />
                  <label id="backofficePrimaryText">Texto</label>
                </div>
              </div>
            </div>

            <div class="subtitle" style="margin-top: 1.5rem">Tema oscuro</div>
            <div class="row row-cols-2">
              <div class="col">
                <div class="color-container">
                  <input
                    type="color"
                    id="backofficePrimaryDark"
                    name="business.backoffice.palette.primaryDark"
                  />
                  <label for="backofficePrimaryDark">Principal</label>
                </div>
              </div>
              <div class="col">
                <div class="color-container" style="margin: 0">
                  <input
                    type="color"
                    id="backofficePrimaryTextDark"
                    name="business.backoffice.palette.primaryTextDark"
                  />
                  <label id="backofficePrimaryTextDark">Color texto</label>
                </div>
              </div>
            </div>

            <div class="subtitle" style="margin-top: 1.5rem">
              Difuminado login <small>(opcional)</small>
            </div>
            <div class="row row-cols-2">
              <div class="col">
                <div class="color-container">
                  <input
                    type="color"
                    id="backofficeGradientStart"
                    name="business.backoffice.gradient.start"
                  />
                  <label for="backofficeGradientStart">Primer color</label>
                </div>
              </div>
              <div class="col">
                <div class="color-container" style="margin: 0">
                  <input
                    type="color"
                    id="backofficeGradientEnd"
                    name="business.backoffice.gradient.end"
                  />
                  <label for="backofficeGradientEnd">Segundo color</label>
                </div>
              </div>
            </div>

            <!-- <div class="last-section">
            <div class="section-title">Iconos</div>
            <h4>Tema claro</h4>
            <div class="row">
              <div class="col">
                <label>Logo</label>
                <input type="file" name="icon_lightImage" />
              </div>
              <div class="col">
                <label>Dashboard header</label>
                <input type="file" name="dashboardHeader_lightImage" />
              </div>
              <div class="col">
                <label>Dashboard subheader</label>
                <input type="file" name="dashboardSubheader_lightImage" />
              </div>
            </div>

            <div class="row">
              <div class="col">
                <label>Dashboard shield</label>
                <input type="file" name="dashboardShield_lightImage" />
              </div>
              <div class="col">
                <label>Dashboard background</label>
                <input type="file" name="dashboardBackground_lightImage" />
              </div>
            </div>

            <h4>Tema oscuro</h4>
            <div class="row">
              <div class="col">
                <label>Logo</label>
                <input type="file" name="icon_darkImage" />
              </div>
              <div class="col">
                <label>Dashboard header</label>
                <input type="file" name="dashboardHeader_darkImage" />
              </div>
              <div class="col">
                <label>Dashboard subheader</label>
                <input type="file" name="dashboardSubheader_darkImage" />
              </div>
            </div>

            <div class="row">
              <div class="col">
                <label>Dashboard shield</label>
                <input type="file" name="dashboardShield_darkImage" />
              </div>
              <div class="col">
                <label>Dashboard background</label>
                <input type="file" name="dashboardBackground_darkImage" />
              </div>
            </div>
          </div> -->
          </div>
        </div>

        <div class="content">
          <button type="submit" id="createButton">Crear cliente</button>
        </div>

        <div class="disclaimer">2023 Goil. All rights reserved.</div>
      </div>
    </form>

    <div class="success-modal" id="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>¡Enhorabuena!</h2>
        </div>
        <div class="modal-body">
          <p>
            Tu negocio ha sido creado correctamente. Descarga la app
            <b>Goil Community</b> y accede con el código de acceso
            <b id="authCodeText">XXXXX</b>.
          </p>

          <p>
            Además, puedes acceder al panel de control de tu negocio con las
            credenciales proporcionadas y empezar a configurar las secciones
            desde:<br /><br />
            <a href="https://community.goil.app" target="_blank" id="fullDomain"
              >https://community.goil.app</a
            >
          </p>
        </div>
        <div class="modal-footer">
          <button class="btn" id="closeModal">Aceptar</button>
        </div>
      </div>
    </div>

    <script>
      function convertArrayToObjectsWithValues(array) {
        let result = {};

        array.forEach((text) => {
          const [key, value] = text.split(":");
          const parts = key.split(".");
          let currentObj = result;

          for (let i = 0; i < parts.length; i++) {
            if (i === parts.length - 1) {
              currentObj[parts[i]] = value.trim();
            } else {
              const part = parts[i];
              if (!currentObj[part]) {
                currentObj[part] = {};
              }
              currentObj = currentObj[part];
            }
          }
        });

        return result;
      }

      document.getElementById("closeModal").addEventListener("click", () => {
        document.getElementById("modal").classList.remove("show");
      });

      const colorInputs = document.querySelectorAll("input[type=color]");

      for (let i = 0; i < colorInputs.length; i++) {
        colorInputs[i].addEventListener("change", function (event) {
          const value = event.target.value;
          const target = this.dataset.target;

          if (target) {
            Array.from(document.getElementsByClassName(target)).forEach(
              (item) => (item.style.backgroundColor = value)
            );
          }
        });
      }

      const fileInputs = document.querySelectorAll("input[type=file]");

      for (let i = 0; i < fileInputs.length; i++) {
        fileInputs[i].addEventListener("change", function (event) {
          const [value] = event.target.files;
          const target = this.dataset.target;

          if (target && value) {
            const image = URL.createObjectURL(value);
            if (target === "dashboardBackground") {
              document.getElementById(
                target
              ).style.backgroundImage = `url(${image})`;
            } else {
              document.getElementById(target).src = image;
            }
          }
        });
      }

      document
        .querySelector("form")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          document.getElementById("createButton").disabled = true;
          document.getElementById("createButton").innerText =
            "Creando cliente...";

          const formData = new FormData(this);
          const dataToSend = new FormData();

          const jsonArray = [];
          formData.forEach(function (value, key) {
            if (value instanceof File) {
              dataToSend.append(key, value);
            } else {
              jsonArray.push(`${key}:${value}`);
            }
          });

          const jsonObject = convertArrayToObjectsWithValues(jsonArray);

          dataToSend.append("business", JSON.stringify(jsonObject.business));
          dataToSend.append("client", JSON.stringify(jsonObject.client));

          const authCode = jsonObject.business.authCode;
          const subDomain = jsonObject.business.subDomain;

          const actionUrl = this.action;

          const xhr = new XMLHttpRequest();
          xhr.open("POST", actionUrl, true);
          //xhr.setRequestHeader("Content-Type", "multipart/form-data");
          xhr.onload = function () {
            document.getElementById("createButton").disabled = false;
            document.getElementById("createButton").innerText = "Crear cliente";

            if (xhr.status >= 200 && xhr.status < 400) {
              this.reset;
              document.getElementById("modal").classList.add("show");
              document.getElementById("authCodeText").innerText = authCode;
              document.getElementById("fullDomain").innerText =
                "https://" + subDomain + ".community.goil.app";
              document.getElementById("fullDomain").href =
                "https://" + subDomain + ".community.goil.app";
              document.getElementById("businessForm").reset();
            } else {
              // Error
              alert(
                "Ha ocurrido un error al crear el cliente. Por favor, inténtelo de nuevo."
              );
              console.error(xhr.statusText);
            }
          };
          xhr.onerror = function () {
            alert(
              "Ha ocurrido un error al crear el cliente. Por favor, inténtelo de nuevo."
            );
            console.error("Network Error");
          };
          xhr.send(dataToSend);
        });
    </script>
  </body>
</html>
